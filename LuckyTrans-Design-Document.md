# LuckyTrans - 设计文档

## 一、产品愿景分析

### 核心定位
LuckyTrans 是一款 **macOS 原生划词翻译工具**，愿景是成为 macOS 上最优雅、最高效的翻译助手。

### 目标用户
- 需要频繁阅读/处理外语文档的 macOS 用户
- 开发者、设计师、学生、翻译工作者
- 追求效率、喜欢快捷键操作的 power user

### 核心体验
```
选中文本 → 按下 Cmd+Shift+T → 翻译结果即时浮现
```
无需切换应用、无需复制粘贴、不打断心流。

---

## 二、当前实现评估

### ✅ 已完成的功能

| 功能 | 实现状态 | 评价 |
|------|---------|------|
| 全局快捷键 | ✅ 完整 | 支持自定义录制 |
| 多层级取词 | ✅ 完整 | Accessibility → AppleScript → 剪贴板 |
| 多服务支持 | ✅ 完整 | OpenAI/Google/DeepL/百度/有道 |
| 悬浮翻译窗 | ✅ 完整 | 已有关键设计元素 |
| 菜单栏管理 | ✅ 完整 | SwiftUI + AppKit 混合 |
| 主题切换 | ✅ 完整 | 浅色/深色/跟随系统 |
| 设置界面 | ✅ 完整 | 基础布局完成 |

### 🔧 需要打磨的方面

| 方面 | 现状 | 目标 |
|------|------|------|
| 悬浮窗设计 | 基础实现 | **精致、现代、动画流畅** |
| 设置界面 | 功能完整但朴素 | **分组清晰、视觉层次** |
| OCR 截图翻译 | 有占位 | **完整的截图+翻译流程** |
| 快捷键录制器 | 基础样式 | **交互反馈、视觉引导** |
| 菜单栏图标 | 单一图标 | **状态指示、动态反馈** |

---

## 三、MVP 产品定义

### MVP 核心功能

```
┌─────────────────────────────────────────────────────────┐
│                    LuckyTrans MVP                       │
├─────────────────────────────────────────────────────────┤
│  1. 划词翻译（核心）                                     │
│     - 全局快捷键触发                                     │
│     - 智能取词（应用内/浏览器/代码编辑器兼容）            │
│     - 悬浮窗显示结果                                     │
│                                                          │
│  2. 翻译服务（基础）                                     │
│     - OpenAI（默认）                                    │
│     - Google Translate                                  │
│     - 服务切换界面                                       │
│                                                          │
│  3. 设置（必要）                                         │
│     - API Key 配置                                      │
│     - 快捷键自定义                                       │
│     - 主题选择                                           │
│                                                          │
│  4. 菜单栏（系统整合）                                    │
│     - 常驻菜单栏                                         │
│     - 快速设置入口                                       │
│     - 关于/退出                                          │
└─────────────────────────────────────────────────────────┘
```

### 不做的事（MVP 阶段）
- ❌ OCR 截图翻译（二期）
- ❌ 翻译历史记录（二期）
- ❌ 词典查询（二期）
- ❌ 多语言同时翻译（二期）
- ❌ iOS 版本（远期）

---

## 四、设计师版本：UI/UX 设计需求

### 🎨 设计语言

**整体风格**: 现代 macOS 原生风格 + 精致微交互

**参考应用**:
- [Raycast](https://www.raycast.com/) - 快捷键驱动的优雅界面
- [Keyden](https://github.com/tasselx/Keyden) - 菜单栏应用的精致设计
- [CleanShot X](https://cleanshot.com/) - 悬浮窗设计

**色彩基调**:
```
主色调: 蓝色系 (#0066CC 或跟随系统强调色)
背景: 半透明毛玻璃效果 (Material)
文字: 系统自适应（支持深色/浅色模式）
```

---

### 界面 1: 悬浮翻译窗（核心界面）

**使用场景**: 用户选中文本后，翻译结果以悬浮窗形式出现在鼠标附近

**设计要求**:

#### 布局结构
```
┌────────────────────────────────────────┐
│  🌐 LuckyTrans          [×]           │  ← 标题栏（可拖拽）
├────────────────────────────────────────┤
│                                        │
│  "The quick brown fox jumps           │  ← 原文（引用样式）
│   over the lazy dog"                  │
│   ──────────────────────               │
│                                        │
│  那只敏捷的棕色狐狸跳过了             │  ← 译文（主体内容）
│  那只懒惰的狗                         │
│                                        │
│  ┌────────────────────────────────┐   │
│  │ 💬 支持流式输出，逐字显示      │   │  ← 可选：打字机效果
│  └────────────────────────────────┘   │
│                                        │
│  [复制译文] [朗读] [在窗口打开]        │  ← 操作按钮
│                                        │
└────────────────────────────────────────┘
```

#### 交互细节
1. **出现动画**: 从鼠标位置缩放淡入，200ms，ease-out
2. **自动关闭**: 成功翻译后 30 秒自动关闭（可配置）
3. **拖拽**: 标题栏可拖拽 reposition
4. **失焦行为**: 点击外部自动关闭
5. **复制反馈**: 复制成功时按钮文字变为"已复制"，1 秒后恢复

#### 视觉层次
- 原文: 灰色、小号、斜体
- 译文: 黑色/白色（根据主题）、大号
- 操作按钮: 次要按钮样式
- 背景: 毛玻璃效果 + 细边框

---

### 界面 2: 设置窗口

**使用场景**: 用户点击菜单栏图标 → 设置

**设计要求**:

#### 布局结构
```
┌──────────────────────────────────────────────┐
│ 🔧 设置                                     × │
├──────────────────────────────────────────────┤
│  ┌──────────┬─────────────────────────────┐  │
│  │ ▶ 通用   │                              │  │
│  │   翻译   │   服务设置                    │  │
│  │   快捷键 │                              │  │
│  │   关于   │   [详细设置表单...]           │  │
│  │          │                              │  │
│  └──────────┴─────────────────────────────┘  │
└──────────────────────────────────────────────┘
```

#### 分 Tab 设计

**Tab 1: 通用**
```
┌──────────────────────────────────────┐
│ 外观                                  │
│ ┌──────────────────────────────────┐ │
│ │ 主题: [浅色] [深色] [跟随系统]    │ │
│ └──────────────────────────────────┘ │
│                                      │
│ 权限                                  │
│ ┌──────────────────────────────────┐ │
│ │ ⚠️ 辅助功能权限未开启             │ │
│ │    [去设置中开启]                 │ │
│ └──────────────────────────────────┘ │
└──────────────────────────────────────┘
```

**Tab 2: 翻译服务**
```
┌──────────────────────────────────────┐
│ 当前服务: OpenAI ▼                   │
│                                      │
│ ┌──────────────────────────────────┐ │
│ │ OpenAI                            │ │
│ │ ────────────────────────────────  │ │
│ │ API Key: [••••••••••••••••] [👁] │ │
│ │ 模型: GPT-4o ▼                    │ │
│ │ 目标语言: 简体中文 ▼               │ │
│ │                                   │ │
│ │ [测试连接] 状态: ✅ 正常           │ │
│ └──────────────────────────────────┘ │
│                                      │
│ 其他服务:                            │
│ ○ Google Translate                   │
│ ○ DeepL                              │
│ ○ 百度翻译                           │
└──────────────────────────────────────┘
```

**Tab 3: 快捷键**
```
┌──────────────────────────────────────┐
│ 划词翻译快捷键                       │
│ ┌──────────────────────────────────┐ │
│ │ 点击录制...                       │ │
│ │ 或: ⌘ ⇧ T                       │ │
│ └──────────────────────────────────┘ │
│                                      │
│ ⚠️ 与系统快捷键冲突: Spotlight      │
│    [使用此快捷键] [重新录制]         │
└──────────────────────────────────────┘
```

---

### 界面 3: 快捷键录制器

**使用场景**: 用户在设置中点击"录制快捷键"

**设计要求**:

```
┌────────────────────────────────────────┐
│                                        │
│      按下你想使用的快捷键组合          │
│                                        │
│         ┌────────────────┐             │
│         │   ⌘ ⇧ T        │             │  ← 实时显示按键
│         └────────────────┘             │
│                                        │
│      [取消]              [确认]        │
│                                        │
└────────────────────────────────────────┘
```

**交互细节**:
- 录制状态: 背景脉冲动画
- 按键显示: 大字体、居中
- 冲突提示: 实时检测，红色警告
- 超时: 5 秒无操作自动取消

---

### 界面 4: 菜单栏

**设计要求**:

#### 菜单栏图标
```
状态 1: 正常      状态 2: 翻译中      状态 3: 出错
┌─────┐          ┌─────┐            ┌─────┐
│ 🌐  │          │ ⏳  │            │ ⚠️  │
└─────┘          └─────┘            └─────┘
静态图标          旋转动画            红色提示
```

#### 下拉菜单
```
┌────────────────────────────┐
│ 🌐 LuckyTrans              │  ← 品牌头部
├────────────────────────────┤
│ ⌨️ 划词翻译          ⌘⇧T   │  ← 主要操作
│ 📋 从剪贴板翻译            │
├────────────────────────────┤
│ ⚙️ 设置...                 │
│ ────────────────────────── │
│ 🔄 检查更新                │
│ ❓ 帮助                   │
├────────────────────────────┤
│ 🚪 退出 LuckyTrans         │
└────────────────────────────┘
```

---

### 界面 5: 空状态/引导

**使用场景**: 首次安装、权限未开启

**设计要求**:

```
┌────────────────────────────────────────┐
│                                        │
│              🔒 需要权限                │
│                                        │
│   LuckyTrans 需要辅助功能权限          │
│   才能获取你选中的文本                 │
│                                        │
│   ┌────────────────────────────────┐   │
│   │ ① 打开系统设置                  │   │
│   │ ② 进入 隐私与安全性 > 辅助功能  │   │
│   │ ③ 勾选 LuckyTrans              │   │
│   └────────────────────────────────┘   │
│                                        │
│        [打开系统设置]                  │
│                                        │
└────────────────────────────────────────┘
```

---

## 五、动画与微交互规范

### 悬浮窗动画
```
出现:
  - Scale: 0.9 → 1.0
  - Opacity: 0 → 1
  - Duration: 200ms
  - Easing: ease-out-cubic

关闭:
  - Opacity: 1 → 0
  - Duration: 150ms
  - Easing: ease-in
```

### 按钮反馈
```
Hover:
  - Background: opacity 0 → 0.1
  - Duration: 100ms

Click:
  - Scale: 1.0 → 0.95 → 1.0
  - Duration: 100ms
```

### 加载状态
```
Translation Loading:
  - 显示原文
  - 下方 Skeleton placeholder 闪烁动画
  - 完成后内容淡入
```

---

## 六、设计交付物清单

### 必需
- [ ] 悬浮翻译窗设计稿（浅色/深色模式）
- [ ] 设置窗口设计稿（所有 Tab）
- [ ] 快捷键录制弹窗设计稿
- [ ] 菜单栏图标（正常/翻译中/错误三种状态）
- [ ] 空状态/引导界面设计稿

### 可选
- [ ] 设计系统（颜色、字体、间距、阴影）
- [ ] 动画原型（悬浮窗出现/关闭）
- [ ] 交互流程图（完整用户旅程）

### 格式要求
- 设计稿: Figma / Sketch
- 切图: @1x @2x PNG + SVG（图标）
- 标注: 间距、字号、色值

---

## 七、技术约束

### 平台
- macOS 13.0+
- SwiftUI + AppKit 混合
- 支持浅色/深色/自动主题

### 性能
- 悬浮窗出现 < 200ms
- 内存占用 < 100MB

---

## 八、参考链接

### 竞品参考
- [Easydict](https://github.com/tisfeng/Easydict) - 功能最完整
- [Bob](https://bobtranslate.com/) - 设计最精致
- [DeepL for Mac](https://www.deepl.com/app) - 官方客户端

### 设计参考
- [Apple Human Interface Guidelines](https://developer.apple.com/design/human-interface-guidelines/)
- [Raycast Design](https://developers.raycast.com/)

---

## 九、附录：现有代码亮点

### 悬浮窗已有设计元素
```swift
// 已有: 毛玻璃背景
RoundedRectangle(cornerRadius: 16)
    .fill(colorScheme == .dark ? Color(nsColor: .windowBackgroundColor) : Color.white)
    .shadow(color: Color.black.opacity(0.1), radius: 15, x: 0, y: 5)

// 已有: 装饰性边框
RoundedRectangle(cornerRadius: 16)
    .stroke(Color.blue.opacity(0.1), lineWidth: 1)

// 已有: 顶部装饰条
Capsule()
    .fill(LinearGradient(gradient: Gradient(colors: [Color.blue.opacity(0.6), Color.purple.opacity(0.6)]), startPoint: .leading, endPoint: .trailing))
    .frame(width: 40, height: 4)
```

设计师可以在此基础上进一步打磨。

---

*文档版本: 1.0*  
*创建日期: 2025-02-03*  
*设计师: [待填写]*
